<!DOCTYPE html>
<html lang="en">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

  <link rel="stylesheet" href="css/main.css">

  <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>


  <style>
  /*#attach-point img {
    max-width: 50px;
    height: auto;
  }*/

  body {
    padding-bottom: 50px;
  }

  #attach-point .col {
    /*white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;*/
    text-align: center;
  }

  #attach-point .table-striped {
    margin-top: 20px;
  }

  .img-cell {
    width: 100px;
  }

  footer {
    background-color: #f7f7f7;
/*    color: white;*/
  }
  </style>

  <title>FFRKreeper</title>
  <body>
    <nav class="navbar navbar-light bg-faded">
      <h1 class="navbar-brand mb-0">FFRKreeper</h1>
    </nav>

    <div class="container-fluid">
      <div class="alert alert-danger">
        <strong>Update:</strong> The app will now tell you when your session id has expired. Please see the instructions for more info.
      </div>
      <div class="row">
        <div class="col-sm">
          <p></p>
          <form>
            <div class="form-group">
              <!-- <label for="session-id">Session ID</label> -->
              <input type="text" class="form-control" id="session-id" placeholder="Paste your session id here">
              <input type="text" class="form-control" id="email" placeholder="Email (optional)">
              <input type="text" class="form-control" id="phone" placeholder="Phone (optional)">
            </div>
          </form>

          <a class="btn btn-block btn-primary" id="btn-instructions" href="#">Show Instructions</a>

          <div id="instructions" style="display: none;">
            <p></p>
            <p>Welcome to FFRKreeper! This app will show you your drops when you join a battle. That way, if it's a shitty drop, you don't have to worry about completing the battle and you can flee and join again until you get a good drop!</p>

            <p>All you need is to get your session id and paste it into the form - and keep the app open somewhere! Read on to find out how to get your session id.</p>

            <h6>Notifications</h6>

            <p>If you want, put your email in there, too. That way, when you get a 5 star drop or better, FFRKreeper will email you.</p>

            <p>Same with phone, but if you put in a phone number, use format "+15555555"</p>

            <p>To Note:</p>
            <ol>
              <li>Notifications are only for 5* items or rarer.</li>
              <li>Sending SMS and Email costs money. If this feature blows up, we may have to pull it</li>
              <li>Email can be a bit slow</li>
              <li>You need to have the app running in a browser window somewhere for notifications to work</li>
            </ol>


            <h6>Mac / iOS</h6>
            <ol>
              <li><a href="http://useyourloaf.com/blog/remote-packet-capture-for-ios-devices/">Using WireShark</a></li>
              <li>Fight a battle</li>
              <li>Parse through the messages from ffrk.denagames.com (maybe by IP address) and find your session id (it'll look like this: Cookie: http_session_sid=xxxxxxxxxxxxxxxxxx). Make sure you don't copy the semicolon or the 'http_session_sid' part.</li>
            </ol>

            <h6>PC / iOS</h6>
            <ol>
              <li><a href="https://blogs.esri.com/esri/supportcenter/2011/12/06/configuring-fiddler-to-capture-web-traffic-from-an-iphone-ipad-device/">Using Fiddler</a></li>
              <li>Play a battle, get the session ID, then plug it into the web app.</li>
            </ol>

            <h6>Android</h6>
            <small>From /u/Pinguino21v</small>
            <ol>
              <li>Install <a href="https://play.google.com/store/apps/details?id=jp.co.taosoftware.android.packetcapture">tPacketCapture</a></li>
              <li>Load it</li>
              <li>Open FFRK and do something (change a menu)</li>
              <li>Quit the VPN connexion (notification bar)</li>
              <li>Open tPacketCapture again to find where the file containing the data is saved</li>
              <li>Copy that file to a PC with WireShark installed</li>
              <li>Open it with WireShark</li>
              <li>Search for "http_session_sid" (ctrl+F) on the packet detail</li>
              <li>Profit</li>
              <li>Or instead of opening it with WireShark on a PC, open the file with a text editor on your phone and find "http_session_sid". It will be easier if the said editor have a "find text" option. Google app "Docs" have it.</li>
            </ol>

            <h6>Notes</h6>
            <ol>
              <li>This app will not work for MP Raid Dungeons, but solo Raid Dungeons are fine</li>
              <li>If the app tells you you're not in a battle and you are, you may need to refresh and get your session id again.</li>
              <li>Keep an eye on the 'status' below. If you become disconnect, refresh and paste your session id again.</li>
            </ol>
          </div>
          <p></p>
          
          <!-- <small>Sanity Check: <span id='server-time'></span></small> -->
        </div>
        <div class="col-sm">
          <div id="attach-point"></div>
        </div>
      </div>
    </div>

    <footer class="fixed-bottom">
      <div class="container-fluid">
        <div class="row">
          <div class="col">
            <div class="d-flex flex-row">
              <div class="p-2"><small>By <a href="http://gunnertech.com">Gunner Technology</a></small></div>
            </div>
          </div>
          <div class="col">
            <div class="d-flex flex-row-reverse">
              <div class="p-2">
                <span class="badge badge-default">Status: Connecting...</span>
                <span style="display: none;" class="badge badge-danger">Status: Disconnected</span>
                <span style="display: none;" class="badge badge-success">Status: Connected</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/index.js?version=1.1"></script>
    
  </body>
</html>
